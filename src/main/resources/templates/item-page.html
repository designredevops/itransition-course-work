<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8"/>
    <title>[[#{item-details}]]</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content=" "/>
    <meta name="keywords" content=""/>
    <meta content="Themesdesign" name="author"/>

    <link rel="shortcut icon" href="/images/favicon.ico">

    <!-- Bootstrap css -->
    <link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css" id="bootstrap-style"/>

    <!-- Material Icon Css -->
    <link rel="stylesheet" href="/css/materialdesignicons.min.css" type="text/css"/>

    <!-- Unicon Css -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0css/line.css"/>

    <!-- Swiper Css -->
    <link rel="stylesheet" href="/css/tiny-slider.css" type="text/css"/>
    <link rel="stylesheet" href="/css/swiper.min.css"/>

    <!-- Custom Css -->
    <link rel="stylesheet" href="/css/style.min.css"/>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"
            integrity="sha512-1QvjE7BtotQjkq8PxLeF6P46gEpBRXuskzIVgjFpekzFVF4yjRgrQvTG1MTOJ3yQgvTteKAcO7DSZI92+u/yZw=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <style type="text/css">
        .customFields {
            margin: 20px 0px;
        }

        .customFieldsMain {
            display: flex;
            width: 100%;
            justify-content: space-between;
            margin: 5px 0px;
            padding: 5px 0px;
            /*border-bottom: 1px solid silver;*/
        }

        .fieldKey {
            font-size: 18px;
            font-weight: 600;
        }

        .fieldValue {
            max-width: 50%;
        }

        .forCheckBox {
            font-size: 30px;
        }

        .m0a {
            margin: 0 auto;
            width: 90%;
        }
    </style>

</head>

<body data-bs-spy="scroll" data-bs-target="#navbar-navlist" data-bs-offset="71"
      th:with="user = ${#authentication.principal}">

<!-- light-dark mode button -->
<a href="javascript: void(0);" id="mode" class="mode-btn text-white rounded-end">
    <i class="uil uil-brightness mode-dark mx-auto"></i>
    <i class="uil uil-moon bx-spin mode-light"></i>
</a>


<!--Navbar Start-->
<nav class="navbar navbar-expand-lg fixed-top sticky" id="navbar">
    <div class="container-fluid custom-container">
        <a class="navbar-brand logo f-30 text-dark fw-bold" th:href="@{/home}">
            <img src="../images/logo-dark.png" class="logo-dark" alt="" height="40">
            <img src="../images/logo-light.png" class="logo-light" alt="" height="40">
        </a>
        <div>
            <form class="search-form" th:action="@{/item/search}" method="get">
                <div class="mb-3 row">
                    <div class="col-sm-10">
                        <input type="text" class="form-control position-relative" id="inputPassword"
                               th:placeholder="#{search}" name="q">
                    </div>
                </div>
            </form>
        </div>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav mx-auto navbar-center">
                <li class="nav-item">
                    <a th:href="@{/home}" class="nav-link">[[#{home}]]</a>
                </li>
                <li class="nav-item dropdown dropdown-hover" th:unless="${user=='anonymousUser'}">
                    <a class="nav-link dropdown-toggle" id="homedrop" role="button"
                       data-bs-toggle="dropdown">
                        [[#{profile}]]
                    </a>
                    <ul class="dropdown-menu dropdown-menu-center" aria-labelledby="homedrop">
                        <li><a class="dropdown-item" th:href="@{/user/my-collections}"><i
                                class="mdi mdi-account-box-outline f-20 me-2 align-middle"></i>[[#{profile}]]</a></li>
                        <li><a class="dropdown-item" th:href="@{/user/edit-profile}"><i
                                class="mdi mdi-account-edit f-20 me-2 align-middle"></i>[[#{edit-profile}]]</a></li>
                    </ul>
                </li>
                <li class="nav-item"
                    th:if="${user!='anonymousUser'} and ${#strings.equals(user.role.roleName,'ROLE_ADMIN')} ">
                    <a th:href="@{/user/management}" class="nav-link">
                        [[#{user-management}]]
                    </a>
                </li>
            </ul>
            <!--end navbar-nav-->
            <a th:if="${user=='anonymousUser'}" th:href="@{/login}" class="btn btn-outline-success">[[#{login}]]</a>
            <a th:if="${user=='anonymousUser'}" th:href="@{/register}"
               class="btn btn-outline-success">[[#{register}]]</a>
            <a th:unless="${user=='anonymousUser'}" th:href="@{/logout}"
               class="btn btn-outline-danger">[[#{logout}]]</a>
        </div>

    </div>
    <!--end container-->
</nav>
<!-- Navbar End -->


<!-- start section -->
<section class="forum section bg-light">
    <!-- start container -->
    <div class="container">
        <div class="row mt-4">
            <div class="col-lg-12">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb default mb-0">
                        <li class="breadcrumb-item">
                            <a th:href="@{/home}" class="text-muted">[[#{home}]]</a>
                        </li>
                        <li class="breadcrumb-item active text-primary" aria-current="page">[[#{item-details}]]</li>
                    </ol>
                </nav>
            </div>
        </div>

        <div class="row align-items-center justify-content-center">
            <div class="col-lg-8">
                <div class="inner-heading text-center">
                    <div class="mt-4">
                        <h1 class="fw-bold">[[#{item-details}]]</h1>
                        <P class="text-muted"></P>
                    </div>
                </div>

                <div class="heading-bottom-icon d-flex justify-content-center text-center">
                    <i class="mdi mdi-image-filter-vintage"></i>
                    <i class="mdi mdi-image-filter-vintage mx-2"></i>
                    <i class="mdi mdi-image-filter-vintage"></i>
                </div>
            </div>
        </div>

        <div class="row mt-5">
            <div class="col-lg-8 order-2 order-lg-1 m0a">
                <div class="forum-item">
                    <div class="forum-box">
                        <div class="d-flex align-items-center justify-content-start">
                            <div class="avatar forum-profile">
                                <img th:src="${item.authorProfileImgUrl}" alt=""
                                     class="img-fluid rounded-circle avatar-md">
                            </div>

                            <!--                            <div class="forum-profile-deatails">-->
                            <!--                                <h6 class="mb-0 ms-2 fw-bold">admin </h6>-->
                            <!--                            </div>-->
                        </div>
                        <div class="forum-details mt-4">
                            <h4 class="fw-bold">[[${item.itemName}]]</h4>
                            <div class="customFields" th:each="customField: ${itemCustomFields}">
                                <div class="customFieldsMain">
                                    <div class="fieldKey">
                                        [[${customField.fieldName}]]
                                    </div>
                                    <div class="fieldValue" th:if="${customField.fieldType=='checkbox'}">
                                        [[${customField.fieldValue}]]
                                    </div>
                                </div>
                            </div>
                            <input type="hidden" th:value="${item.id}" id="itemId">
                            <!--                            <div th:each="tag: ${item.tagsByItemId}">-->
                            <a th:each="tag: ${item.tagsByItemId}" th:href="@{'/item/tag?tagId='+${tag.id}}"
                               class="badge rounded-pill shadow-sm border text-blue py-2 px-3 f-14 fw-normal">
                                #[[${tag.name}]]
                            </a>
                            <!--                            </div>-->
                            <hr class="my-4">

                            <div class="d-flex">
                                <div class="like">
                                    <h6 class="f-14 fw-semibold"><a
                                            th:href="@{'/item/like?itemId='+${item.id}}">
                                        <i th:class="${item.isLiked!=null and item.isLiked}?
                                            'mdi mdi-heart text-danger f-18 align-middle me-2':
                                                'mdi mdi-heart-outline text-danger f-18 align-middle me-2'"></i>
                                    </a>[[${item.itemLikes}]]
                                    </h6>
                                </div>
                                <div class="message ms-3">
                                    <h6 class="f-14 fw-semibold"><i
                                            class="mdi mdi-message-outline text-muted f-18 align-middle me-2"></i>[[${item.itemCommentsNumber}]]
                                        [[#{comment}]]
                                    </h6>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="forum-form mt-4">
                        <div class="row d-flex align-items-center justify-content-start">
                            <div class="col-sm-2 col-3">
                                <div class="avatar forum-profile" th:unless="${user=='anonymousUser'}">
                                    <img th:src="${user.profileImgUrl}" alt=""
                                         class="img-fluid rounded-circle avatar-md">
                                </div>
                            </div>
                            <div class="col-xl-8 col-md-6 col-5 my-2">
                                <form>
                                    <input type="text" class="form-control" id="commentBody"
                                           th:placeholder="#{add-comment}" th:onfocus="checkUserAuth([[${user}]])">
                                </form>
                            </div>
                            <div class="col-2">
                                <button class="btn btn-dark" onclick="leaveComment()">[[#{send}]]</button>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="my-5">
                                <h6 class="text-success fw-bold"><i
                                        class="mdi mdi-message-text-outline f-20 align-middle me-2"></i>[[#{comment}]]:
                                </h6>
                            </div>
                        </div>
                    </div>
                    <div class="answer-process-details">
                        <div id="comments">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end container -->
</section>
<div id="loginModal"></div>
<script th:src="@{/webjars/stomp-websocket/2.3.4/stomp.js}" type="text/javascript"></script>
<script th:src="@{/js/app.js}">
</script>
<script>
    let itemId = document.querySelector('#itemId').value
    connectToWebSocket(itemId)
</script>
<!--Bootstrap Js-->
<script src="/js/bootstrap.bundle.min.js"></script>

<!-- Slider Js -->
<script src="/js/swiper.min.js"></script>

<!-- counter -->
<script src="/js/counter.init.js"></script>

</body>
</html>
